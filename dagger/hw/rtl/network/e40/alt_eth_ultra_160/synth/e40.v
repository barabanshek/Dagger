// e40.v

// Generated using ACDS version 16.0 208

`timescale 1 ps / 1 ps
module e40 (
		input  wire [0:0]   clk_ref,               //              clk_ref.clk_ref
		output wire [0:0]   clk_rxmac,             //            clk_rxmac.clk_rxmac
		input  wire [0:0]   clk_status,            //           clk_status.clk_status
		output wire [0:0]   clk_txmac,             //            clk_txmac.clk_txmac
		output wire         dout_valid,            //         custom_st_rx.dout_valid
		output wire [127:0] dout_d,                //                     .dout_d
		output wire [15:0]  dout_c,                //                     .dout_c
		output wire [1:0]   dout_sop,              //                     .dout_sop
		output wire [1:0]   dout_eop,              //                     .dout_eop
		output wire [5:0]   dout_eop_empty,        //                     .dout_eop_empty
		output wire [1:0]   dout_idle,             //                     .dout_idle
		output wire [5:0]   rx_error,              //                     .rx_error
		output wire [2:0]   rx_status,             //                     .rx_status
		output wire         rx_fcs_error,          //                     .rx_fcs_error
		output wire         rx_fcs_valid,          //                     .rx_fcs_valid
		input  wire [1:0]   din_sop,               //         custom_st_tx.din_sop
		input  wire [1:0]   din_eop,               //                     .din_eop
		input  wire [1:0]   din_idle,              //                     .din_idle
		input  wire [5:0]   din_eop_empty,         //                     .din_eop_empty
		input  wire [127:0] din,                   //                     .din
		output wire         din_req,               //                     .din_req
		input  wire [1:0]   tx_error,              //                     .tx_error
		input  wire [11:0]  reconfig_address,      //     reconfig_address.reconfig_address
		input  wire [0:0]   reconfig_clk,          //         reconfig_clk.reconfig_clk
		input  wire [0:0]   reconfig_read,         //        reconfig_read.reconfig_read
		output wire [31:0]  reconfig_readdata,     //    reconfig_readdata.reconfig_readdata
		input  wire [0:0]   reconfig_reset,        //       reconfig_reset.reconfig_reset
		output wire [0:0]   reconfig_waitrequest,  // reconfig_waitrequest.reconfig_waitrequest
		input  wire [0:0]   reconfig_write,        //       reconfig_write.reconfig_write
		input  wire [31:0]  reconfig_writedata,    //   reconfig_writedata.reconfig_writedata
		input  wire [0:0]   reset_async,           //          reset_async.reset_async
		input  wire [0:0]   reset_status,          //         reset_status.reset_status
		output wire [0:0]   rx_pcs_ready,          //         rx_pcs_ready.rx_pcs_ready
		input  wire [3:0]   rx_serial,             //            rx_serial.rx_serial
		output wire [15:0]  rx_inc_octetsOK,       //             rx_stats.rx_inc_octetsOK
		output wire [0:0]   rx_inc_octetsOK_valid, //                     .rx_inc_octetsOK_valid
		output wire [0:0]   rx_inc_runt,           //                     .rx_inc_runt
		output wire [0:0]   rx_inc_64,             //                     .rx_inc_64
		output wire [0:0]   rx_inc_127,            //                     .rx_inc_127
		output wire [0:0]   rx_inc_255,            //                     .rx_inc_255
		output wire [0:0]   rx_inc_511,            //                     .rx_inc_511
		output wire [0:0]   rx_inc_1023,           //                     .rx_inc_1023
		output wire [0:0]   rx_inc_1518,           //                     .rx_inc_1518
		output wire [0:0]   rx_inc_max,            //                     .rx_inc_max
		output wire [0:0]   rx_inc_over,           //                     .rx_inc_over
		output wire [0:0]   rx_inc_mcast_data_err, //                     .rx_inc_mcast_data_err
		output wire [0:0]   rx_inc_mcast_data_ok,  //                     .rx_inc_mcast_data_ok
		output wire [0:0]   rx_inc_bcast_data_err, //                     .rx_inc_bcast_data_err
		output wire [0:0]   rx_inc_bcast_data_ok,  //                     .rx_inc_bcast_data_ok
		output wire [0:0]   rx_inc_ucast_data_err, //                     .rx_inc_ucast_data_err
		output wire [0:0]   rx_inc_ucast_data_ok,  //                     .rx_inc_ucast_data_ok
		output wire [0:0]   rx_inc_mcast_ctrl,     //                     .rx_inc_mcast_ctrl
		output wire [0:0]   rx_inc_bcast_ctrl,     //                     .rx_inc_bcast_ctrl
		output wire [0:0]   rx_inc_ucast_ctrl,     //                     .rx_inc_ucast_ctrl
		output wire [0:0]   rx_inc_pause,          //                     .rx_inc_pause
		output wire [0:0]   rx_inc_fcs_err,        //                     .rx_inc_fcs_err
		output wire [0:0]   rx_inc_fragment,       //                     .rx_inc_fragment
		output wire [0:0]   rx_inc_jabber,         //                     .rx_inc_jabber
		output wire [0:0]   rx_inc_sizeok_fcserr,  //                     .rx_inc_sizeok_fcserr
		output wire [0:0]   rx_inc_pause_ctrl_err, //                     .rx_inc_pause_ctrl_err
		output wire [0:0]   rx_inc_mcast_ctrl_err, //                     .rx_inc_mcast_ctrl_err
		output wire [0:0]   rx_inc_bcast_ctrl_err, //                     .rx_inc_bcast_ctrl_err
		output wire [0:0]   rx_inc_ucast_ctrl_err, //                     .rx_inc_ucast_ctrl_err
		input  wire [0:0]   status_write,          //          status_avmm.status_write
		input  wire [0:0]   status_read,           //                     .status_read
		input  wire [15:0]  status_addr,           //                     .status_addr
		input  wire [31:0]  status_writedata,      //                     .status_writedata
		output wire [31:0]  status_readdata,       //                     .status_readdata
		output wire [0:0]   status_readdata_valid, //                     .status_readdata_valid
		output wire [0:0]   status_waitrequest,    //                     .status_waitrequest
		output wire [0:0]   status_read_timeout,   //                     .status_read_timeout
		output wire [0:0]   tx_lanes_stable,       //      tx_lanes_stable.tx_lanes_stable
		input  wire [0:0]   tx_pll_locked,         //        tx_pll_locked.tx_pll_locked
		output wire [3:0]   tx_serial,             //            tx_serial.tx_serial
		input  wire [3:0]   tx_serial_clk,         //        tx_serial_clk.tx_serial_clk
		output wire [15:0]  tx_inc_octetsOK,       //             tx_stats.tx_inc_octetsOK
		output wire [0:0]   tx_inc_octetsOK_valid, //                     .tx_inc_octetsOK_valid
		output wire [0:0]   tx_inc_64,             //                     .tx_inc_64
		output wire [0:0]   tx_inc_127,            //                     .tx_inc_127
		output wire [0:0]   tx_inc_255,            //                     .tx_inc_255
		output wire [0:0]   tx_inc_511,            //                     .tx_inc_511
		output wire [0:0]   tx_inc_1023,           //                     .tx_inc_1023
		output wire [0:0]   tx_inc_1518,           //                     .tx_inc_1518
		output wire [0:0]   tx_inc_max,            //                     .tx_inc_max
		output wire [0:0]   tx_inc_over,           //                     .tx_inc_over
		output wire [0:0]   tx_inc_mcast_data_err, //                     .tx_inc_mcast_data_err
		output wire [0:0]   tx_inc_mcast_data_ok,  //                     .tx_inc_mcast_data_ok
		output wire [0:0]   tx_inc_bcast_data_err, //                     .tx_inc_bcast_data_err
		output wire [0:0]   tx_inc_bcast_data_ok,  //                     .tx_inc_bcast_data_ok
		output wire [0:0]   tx_inc_ucast_data_err, //                     .tx_inc_ucast_data_err
		output wire [0:0]   tx_inc_ucast_data_ok,  //                     .tx_inc_ucast_data_ok
		output wire [0:0]   tx_inc_mcast_ctrl,     //                     .tx_inc_mcast_ctrl
		output wire [0:0]   tx_inc_bcast_ctrl,     //                     .tx_inc_bcast_ctrl
		output wire [0:0]   tx_inc_ucast_ctrl,     //                     .tx_inc_ucast_ctrl
		output wire [0:0]   tx_inc_pause,          //                     .tx_inc_pause
		output wire [0:0]   tx_inc_fcs_err,        //                     .tx_inc_fcs_err
		output wire [0:0]   tx_inc_fragment,       //                     .tx_inc_fragment
		output wire [0:0]   tx_inc_jabber,         //                     .tx_inc_jabber
		output wire [0:0]   tx_inc_sizeok_fcserr,   //                     .tx_inc_sizeok_fcserr
		
		input stacker_ram_ena
	);

// PLL generated to IO and digital
wire clk_tx_main;
wire clk_rx_main;

//////////////////////////////////////////////
// jtag byte stream 
//////////////////////////////////////////////

wire clk = clk_rx_main;

wire stacker_ram_ena_s;
alt_sync_regs_m2 (
	.clk(clk),
	.din(stacker_ram_ena),
	.dout(stacker_ram_ena_s)
);

wire [7:0] byte_to_jtag;
wire [7:0] byte_from_jtag;
wire byte_to_jtag_valid;
wire byte_from_jtag_ack;

localparam SIM_FAKE_JTAG = 0;
localparam ENA_JTAG_TERM = 1;

generate 
    if (SIM_FAKE_JTAG) begin


        // load keystream from text file
        integer ifile = 0;
        integer ch = 0;
        initial begin
            ifile = $fopen ("alt_aeu_40_rx_pcs_2_in.txt","r");
            if (ifile == 0) begin
                $display ("Unable to read keystream data file");
                $stop();
            end
        end     
                        
        reg [7:0] file_byte = 8'h0;
        always @(posedge clk) begin
            if (byte_from_jtag_ack) begin
                if (ifile != 0) begin
                    ch = $fgetc (ifile);
                    if (ch == -1) begin
                        file_byte <= 0;
                        if (ifile != 0) begin
                            $display ("Info : input file exhausted, closing");
                            $fclose (ifile);
                            ifile = 0;
                        end
                    end
                    else 
                        file_byte <= ch[7:0];
                    end
                else 
                    file_byte <= 0;
                end
                if (byte_to_jtag_valid) begin
                    $write ("%c",byte_to_jtag);
                end
            end
            assign byte_from_jtag = file_byte;
    end
    else if (ENA_JTAG_TERM) begin
    
		jtag_bytes jb (
			.clk(clk),
			.sclr(sclr),

			.byte_to_jtag(byte_to_jtag),
			.byte_to_jtag_valid(byte_to_jtag_valid),

			.byte_from_jtag(byte_from_jtag),
			.byte_from_jtag_ack(byte_from_jtag_ack)
		);
	end
    else begin
		assign byte_from_jtag = 8'h0;
    end    
endgenerate

////////////////////////////////////
// Ethernet MAC and PCS digital 
////////////////////////////////////

// digital ethernet to serdes
wire pll_powerdown;
wire tx_analogreset;
wire tx_digitalreset;
wire rx_analogreset;
wire rx_digitalreset;
wire [3:0] eio_sloop;
wire set_data_lock;
wire set_ref_lock;

// txdata
wire [4*40-1:0] eio_din;
wire eio_tx_online;
wire eio_din_valid;
        
// external plls converting serdes to mac rates
wire rxp_rst;
wire rxp_lock;
wire txp_rst;
wire txp_lock;

// serdes to digital ethernet
wire  [3:0] eio_tx_clkout;
wire  [3:0] eio_rx_clkout;
wire [3:0] eio_freq_lock;
wire tx_cal_busy;
wire rx_cal_busy;

// fifo status
wire [3:0] tx_full,tx_empty,tx_pfull,tx_pempty;
wire [3:0] rx_full,rx_empty,rx_pfull,rx_pempty;

// rxdata
wire [4*40-1:0] eio_dout;
wire eio_dout_req;


localparam PHY_REFCLK = 1;

	alt_aeu_40_top #(
		.ES_DEVICE            (0),
		.SYNOPT_AVALON        (0),
		.SYNOPT_CAUI4         (0),
		.SYNOPT_C4_RSFEC      (0),
		.SYNOPT_SYNC_E        (0),
		.PHY_REFCLK           (PHY_REFCLK),
		.REF_CLK_FREQ_10G     ("644.53125 MHz"),
		.EXT_TX_PLL           (0),
		.SYNOPT_PAUSE_TYPE    (0),
		.SYNOPT_AVG_IPG       (12),
		.SYNOPT_PTP           (0),
		.SYNOPT_96B_PTP       (1),
		.SYNOPT_64B_PTP       (0),
		.PTP_FP_WIDTH         (1),
		.SYNOPT_LINK_FAULT    (0),
		.SYNOPT_TXCRC_INS     (1),
		.SYNOPT_MAC_DIC       (1),
		.SYNOPT_PREAMBLE_PASS (0),
		.SYNOPT_ALIGN_FCSEOP  (1),
		.SYNOPT_MAC_TXSTATS   (1),
		.SYNOPT_MAC_RXSTATS   (1),
		.FCBITS               (1),
		.FASTSIM              (0),
		.TIMING_MODE          (0),
		.RST_CNTR             (16),
		.AM_CNT_BITS          (14),
		.SIM_FAKE_JTAG        (0),
		.CREATE_TX_SKEW       (0),
		.TARGET_CHIP          (5),
		.ENA_KR4              (0),
		.SYNTH_SEQ            (1),
		.STATUS_CLK_KHZ       (100000),
		.SYNTH_FEC            (0),
		.SYNTH_AN             (1),
		.SYNTH_LT             (1),
		.LINK_TIMER_KR        (504),
		.BERWIDTH             (9),
		.TRNWTWIDTH           (7),
		.MAINTAPWIDTH         (5),
		.POSTTAPWIDTH         (6),
		.PRETAPWIDTH          (5),
		.VMAXRULE             (30),
		.VMINRULE             (6),
		.VODMINRULE           (14),
		.VPOSTRULE            (25),
		.VPRERULE             (16),
		.PREMAINVAL           (30),
		.PREPOSTVAL           (0),
		.PREPREVAL            (0),
		.INITMAINVAL          (25),
		.INITPOSTVAL          (22),
		.INITPREVAL           (3),
		.USE_DEBUG_CPU        (0),
		.AN_CHAN              (1),
		.AN_PAUSE             (3),
		.AN_TECH              (8),
		.CAPABLE_FEC          (1),
		.ENABLE_FEC           (1)
	) alt_eth_ultra_0 (
		.clk_ref                                        (clk_ref),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               //              clk_ref.clk_ref
		.reset_async                                    (reset_async),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //          reset_async.reset_async
		.clk_status                                     (clk_status),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //           clk_status.clk_status
		.reset_status                                   (reset_status),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //         reset_status.reset_status
		.status_write                                   (status_write),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //          status_avmm.status_write
		.status_read                                    (status_read),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .status_read
		.status_addr                                    (status_addr),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .status_addr
		.status_writedata                               (status_writedata),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //                     .status_writedata
		.status_readdata                                (status_readdata),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //                     .status_readdata
		.status_readdata_valid                          (status_readdata_valid),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .status_readdata_valid
		.status_waitrequest                             (status_waitrequest),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //                     .status_waitrequest
		.status_read_timeout                            (status_read_timeout),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   //                     .status_read_timeout
		.tx_lanes_stable                                (tx_lanes_stable),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //      tx_lanes_stable.tx_lanes_stable
		.rx_pcs_ready                                   (rx_pcs_ready),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //         rx_pcs_ready.rx_pcs_ready
		.rx_inc_octetsOK                                (rx_inc_octetsOK),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //             rx_stats.rx_inc_octetsOK
		.rx_inc_octetsOK_valid                          (rx_inc_octetsOK_valid),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_octetsOK_valid
		.rx_inc_runt                                    (rx_inc_runt),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .rx_inc_runt
		.rx_inc_64                                      (rx_inc_64),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             //                     .rx_inc_64
		.rx_inc_127                                     (rx_inc_127),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .rx_inc_127
		.rx_inc_255                                     (rx_inc_255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .rx_inc_255
		.rx_inc_511                                     (rx_inc_511),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .rx_inc_511
		.rx_inc_1023                                    (rx_inc_1023),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .rx_inc_1023
		.rx_inc_1518                                    (rx_inc_1518),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .rx_inc_1518
		.rx_inc_max                                     (rx_inc_max),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .rx_inc_max
		.rx_inc_over                                    (rx_inc_over),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .rx_inc_over
		.rx_inc_mcast_data_err                          (rx_inc_mcast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_mcast_data_err
		.rx_inc_mcast_data_ok                           (rx_inc_mcast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .rx_inc_mcast_data_ok
		.rx_inc_bcast_data_err                          (rx_inc_bcast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_bcast_data_err
		.rx_inc_bcast_data_ok                           (rx_inc_bcast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .rx_inc_bcast_data_ok
		.rx_inc_ucast_data_err                          (rx_inc_ucast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_ucast_data_err
		.rx_inc_ucast_data_ok                           (rx_inc_ucast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .rx_inc_ucast_data_ok
		.rx_inc_mcast_ctrl                              (rx_inc_mcast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .rx_inc_mcast_ctrl
		.rx_inc_bcast_ctrl                              (rx_inc_bcast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .rx_inc_bcast_ctrl
		.rx_inc_ucast_ctrl                              (rx_inc_ucast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .rx_inc_ucast_ctrl
		.rx_inc_pause                                   (rx_inc_pause),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //                     .rx_inc_pause
		.rx_inc_fcs_err                                 (rx_inc_fcs_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //                     .rx_inc_fcs_err
		.rx_inc_fragment                                (rx_inc_fragment),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //                     .rx_inc_fragment
		.rx_inc_jabber                                  (rx_inc_jabber),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         //                     .rx_inc_jabber
		.rx_inc_sizeok_fcserr                           (rx_inc_sizeok_fcserr),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .rx_inc_sizeok_fcserr
		.rx_inc_pause_ctrl_err                          (rx_inc_pause_ctrl_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_pause_ctrl_err
		.rx_inc_mcast_ctrl_err                          (rx_inc_mcast_ctrl_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_mcast_ctrl_err
		.rx_inc_bcast_ctrl_err                          (rx_inc_bcast_ctrl_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_bcast_ctrl_err
		.rx_inc_ucast_ctrl_err                          (rx_inc_ucast_ctrl_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .rx_inc_ucast_ctrl_err
		.tx_inc_octetsOK                                (tx_inc_octetsOK),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //             tx_stats.tx_inc_octetsOK
		.tx_inc_octetsOK_valid                          (tx_inc_octetsOK_valid),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .tx_inc_octetsOK_valid
		.tx_inc_64                                      (tx_inc_64),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             //                     .tx_inc_64
		.tx_inc_127                                     (tx_inc_127),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .tx_inc_127
		.tx_inc_255                                     (tx_inc_255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .tx_inc_255
		.tx_inc_511                                     (tx_inc_511),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .tx_inc_511
		.tx_inc_1023                                    (tx_inc_1023),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .tx_inc_1023
		.tx_inc_1518                                    (tx_inc_1518),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .tx_inc_1518
		.tx_inc_max                                     (tx_inc_max),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //                     .tx_inc_max
		.tx_inc_over                                    (tx_inc_over),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           //                     .tx_inc_over
		.tx_inc_mcast_data_err                          (tx_inc_mcast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .tx_inc_mcast_data_err
		.tx_inc_mcast_data_ok                           (tx_inc_mcast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .tx_inc_mcast_data_ok
		.tx_inc_bcast_data_err                          (tx_inc_bcast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .tx_inc_bcast_data_err
		.tx_inc_bcast_data_ok                           (tx_inc_bcast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .tx_inc_bcast_data_ok
		.tx_inc_ucast_data_err                          (tx_inc_ucast_data_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //                     .tx_inc_ucast_data_err
		.tx_inc_ucast_data_ok                           (tx_inc_ucast_data_ok),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .tx_inc_ucast_data_ok
		.tx_inc_mcast_ctrl                              (tx_inc_mcast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .tx_inc_mcast_ctrl
		.tx_inc_bcast_ctrl                              (tx_inc_bcast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .tx_inc_bcast_ctrl
		.tx_inc_ucast_ctrl                              (tx_inc_ucast_ctrl),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //                     .tx_inc_ucast_ctrl
		.tx_inc_pause                                   (tx_inc_pause),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //                     .tx_inc_pause
		.tx_inc_fcs_err                                 (tx_inc_fcs_err),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //                     .tx_inc_fcs_err
		.tx_inc_fragment                                (tx_inc_fragment),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       //                     .tx_inc_fragment
		.tx_inc_jabber                                  (tx_inc_jabber),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         //                     .tx_inc_jabber
		.tx_inc_sizeok_fcserr                           (tx_inc_sizeok_fcserr),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //                     .tx_inc_sizeok_fcserr
		.tx_pll_locked                                  (tx_pll_locked),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         //        tx_pll_locked.tx_pll_locked
		.din_sop                                        (din_sop),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               //         custom_st_tx.din_sop
		.din_eop                                        (din_eop),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               //                     .din_eop
		.din_idle                                       (din_idle),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //                     .din_idle
		.din_eop_empty                                  (din_eop_empty),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         //                     .din_eop_empty
		.din                                            (din),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   //                     .din
		.din_req                                        (din_req),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               //                     .din_req
		.tx_error                                       (tx_error),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //                     .tx_error
		.dout_valid                                     (dout_valid),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //         custom_st_rx.dout_valid
		.dout_d                                         (dout_d),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                //                     .dout_d
		.dout_c                                         (dout_c),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                //                     .dout_c
		.dout_sop                                       (dout_sop),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //                     .dout_sop
		.dout_eop                                       (dout_eop),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //                     .dout_eop
		.dout_eop_empty                                 (dout_eop_empty),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //                     .dout_eop_empty
		.dout_idle                                      (dout_idle),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             //                     .dout_idle
		.rx_error                                       (rx_error),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //                     .rx_error
		.rx_status                                      (rx_status),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             //                     .rx_status
		.rx_fcs_error                                   (rx_fcs_error),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //                     .rx_fcs_error
		.rx_fcs_valid                                   (rx_fcs_valid),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          //                     .rx_fcs_valid
		.clk_txmac_in                                   (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.l4_tx_startofpacket                            (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.l4_tx_endofpacket                              (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.l4_tx_valid                                    (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.l4_tx_ready                                    (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_tx_empty                                    (5'b00000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              //          (terminated)
		.l4_tx_data                                     (256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                 //          (terminated)
		.l4_rx_error                                    (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_status                                   (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_valid                                    (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_startofpacket                            (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_endofpacket                              (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_data                                     (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_empty                                    (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_fcs_error                                (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.l4_rx_fcs_valid                                (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.pause_insert_tx                                (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.pause_receive_rx                               (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.unidirectional_en                              (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.link_fault_gen_en                              (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.remote_fault_status                            (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.local_fault_status                             (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_in_ptp_asm                                  (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tod_exit_cust                                  (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.ts_out_cust                                    (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.ts_out_cust_asm                                (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tod_cust_in                                    (96'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.RX_CORE_CLK                                    (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.TX_CORE_CLK                                    (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.l4_tx_error                                    (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.rx_time_of_day_96b_data                        (96'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.rx_time_of_day_64b_data                        (64'b0000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_time_of_day_96b_data                        (96'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_time_of_day_64b_data                        (64'b0000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.rx_ingress_timestamp_96b_data                  (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.rx_ingress_timestamp_96b_valid                 (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_egress_timestamp_96b_data                   (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_etstamp_ins_ctrl_ingress_timestamp_96b      (96'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_egress_timestamp_96b_valid                  (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_egress_timestamp_96b_fingerprint            (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.rx_ingress_timestamp_64b_data                  (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.rx_ingress_timestamp_64b_valid                 (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_egress_timestamp_64b_data                   (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_etstamp_ins_ctrl_ingress_timestamp_64b      (64'b0000000000000000000000000000000000000000000000000000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_egress_timestamp_64b_valid                  (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_egress_timestamp_64b_fingerprint            (),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //          (terminated)
		.tx_egress_timestamp_request_valid              (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_egress_timestamp_request_fingerprint        (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_egress_asymmetry_update                     (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_timestamp_insert           (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_timestamp_format           (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_residence_time_update      (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_residence_time_calc_format (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_checksum_zero              (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_checksum_correct           (1'b0),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_offset_timestamp           (16'b0000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_offset_correction_field    (16'b0000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_offset_checksum_field      (16'b0000000000000000),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)
		.tx_etstamp_ins_ctrl_offset_checksum_correction (16'b0000000000000000) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  //          (terminated)

		.pll_powerdown (pll_powerdown),
		.tx_analogreset (tx_analogreset),
		.tx_digitalreset (tx_digitalreset),
		.rx_analogreset (rx_analogreset),
		.rx_digitalreset (rx_digitalreset),

		.rxp_rst (rxp_rst),
		.rxp_lock (rxp_lock),
		.txp_rst (txp_rst),
		.txp_lock (txp_lock),
		
	//	.eio_tx_clkout(eio_tx_clkout[3:0]),
	//	.eio_rx_clkout(eio_rx_clkout[3:0]),

		.eio_tx_clkout(4'b0),
		.eio_rx_clkout(4'b0),

		.clk_tx_main(clk_tx_main),
		.clk_rx_main(clk_rx_main),
		
		.eio_din(eio_din),
		.eio_tx_online(eio_tx_online),
		.eio_din_valid(eio_din_valid),
        
		.eio_dout(eio_dout),
		.eio_dout_req(eio_dout_req),
		
		.eio_freq_lock(eio_freq_lock),
		.eio_sloop(eio_sloop),
		
		// fifo status
		.tx_full(tx_full),
		.tx_empty(tx_empty),
		.tx_pfull(tx_pfull),
		.tx_pempty(tx_pempty),
		.rx_full(rx_full),
		.rx_empty(rx_empty),
		.rx_pfull(rx_pfull),
		.rx_pempty(rx_pempty),
		
		.tx_cal_busy(tx_cal_busy),
		.rx_cal_busy(rx_cal_busy),
		.set_data_lock(set_data_lock),
		.set_ref_lock(set_ref_lock),
		
		// debug text terminal
		.byte_to_jtag(byte_to_jtag),
		.byte_from_jtag(byte_from_jtag),
		.byte_to_jtag_valid(byte_to_jtag_valid),
		.byte_from_jtag_ack(byte_from_jtag_ack),
		
		.stacker_ram_ena (stacker_ram_ena_s)
);





////////////////////////////////////
// MAC plls 
////////////////////////////////////

wire clk_rx_recover = eio_rx_clkout[2];

e40_rx_pll rxp (
	.refclk(clk_rx_recover),  
	.rst(rxp_rst),     
	.outclk_0(clk_rx_main),
	.outclk_1(),   
	.locked(rxp_lock) 
);

generate
	if (PHY_REFCLK==1) begin : TX_PLL_644
		 e40_tx_pll_644 txp (
					.refclk(clk_ref),  
					.rst(txp_rst),     
					.outclk_0(clk_tx_main),
					.outclk_1(),   
					.locked(txp_lock) 
		 );
	end else begin : TX_PLL_322 
		 e40_tx_pll_322 txp (
					.refclk(clk_ref),  
					.rst(txp_rst),     
					.outclk_0(clk_tx_main),
					.outclk_1(),   
					.locked(txp_lock) 
		 );
	end 
endgenerate

assign clk_rxmac = clk_rx_main;
assign clk_txmac = clk_tx_main;


////////////////////////////////////
// serdes IO registers
////////////////////////////////////

reg [40*4-1:0] tx_launch = 0 /* synthesis preserve */;
reg [3:0] tx_valid = 0 /* synthesis preserve */;

always @(posedge clk_tx_main) begin
	tx_launch <= eio_din;
    tx_valid <= {4{eio_din_valid & eio_tx_online}};
end

wire [3:0] eio_tx_data_valid = tx_valid;

reg [40*4-1:0] rx_capture = 0 /* synthesis preserve */;
wire [4*40-1:0] rxd_wires;

always @(posedge clk_rx_main) begin
	rx_capture <= rxd_wires;        
end
assign eio_dout = rx_capture;

reg [3:0] rx_req = 0 /* synthesis preserve */;
always @(posedge clk_rx_main) begin
	rx_req <= {4{eio_dout_req}};
end
wire [3:0] eio_rx_rd_en = rx_req;

////////////////////////////////////
// serdes pin array
////////////////////////////////////


a10_40bit_4pack # (
    .PHY_REFCLK (PHY_REFCLK)
) fp (
    .pll_refclk(clk_ref),
  
    .pll_pd(pll_powerdown),
    .rst_txa(tx_analogreset),
    .rst_txd(tx_digitalreset),
    .rst_rxa(rx_analogreset),
    .rst_rxd(rx_digitalreset),

    .tx_clkout(eio_tx_clkout[3:0]),
    .rx_clkout(eio_rx_clkout[3:0]),

	.clk_tx_common(clk_tx_main),
    .clk_rx_common(clk_rx_main),
                   
    .tx_pin(tx_serial[3:0]),
    .rx_pin(rx_serial[3:0]),

    .tx_din(tx_launch[4*40-1:0]),
    .rx_dout(rxd_wires[4*40-1:0]),
    .tx_valid(eio_tx_data_valid[3:0]),
    
    .rx_ready(eio_rx_rd_en[3:0]),
    .rx_fifo_aclr(4'b0),
    .rx_bitslip(4'b0),
    .rx_valid(),

	.rx_datalocked(eio_freq_lock[3:0]),
    .rx_seriallpbken(eio_sloop[3:0]),
                           
    .tx_full(tx_full[3:0]),
    .tx_pfull(tx_pfull[3:0]),
    .tx_empty(tx_empty[3:0]),
    .tx_pempty(tx_pempty[3:0]),
    .rx_full(rx_full[3:0]),
    .rx_pfull(rx_pfull[3:0]),
    .rx_empty(rx_empty[3:0]),
    .rx_pempty(rx_pempty[3:0]),

    .tx_cal_busy(tx_cal_busy),
    .rx_cal_busy(rx_cal_busy),
	
	.tx_serial_clk(tx_serial_clk),
    
    .set_lock_data(set_data_lock),
    .set_lock_ref(set_ref_lock),     
    
    .reconfig_clk(reconfig_clk),                    // input  wire [0:0]   
    .reconfig_reset(reconfig_reset),                // input  wire [0:0]   
    .reconfig_write(reconfig_write),                // input  wire [0:0]   
    .reconfig_read(reconfig_read),                  // input  wire [0:0]   
    .reconfig_address(reconfig_address),            // input  wire [11:0]  
    .reconfig_writedata(reconfig_writedata),        // input  wire [31:0]  
    .reconfig_readdata(reconfig_readdata),          // output wire [31:0]  
    .reconfig_waitrequest(reconfig_waitrequest)     // output wire [0:0]   
);


endmodule
